[workspace]
channels = ["conda-forge"]
platforms = ["osx-arm64", "linux-64"]

[dependencies]
python = ">=3.10"
basemap = "*"
geopy = "*"
h5py = "*"
matplotlib = "*"
networkx = "*"
numpy = ">=1.19.5"
pandas = "*"
paramiko = "*"
psycopg2-binary = "*"
scandir = ">=1.6"
scikit-learn = ">=1.1"
scipy = "*"
tqdm = "*"
pytest = "*"
pytest-cov = "*"
ruff = "*"
xmltodict = "*"
scikit-image = "*"
shapely = "*"
obspy = "*"
pip = "*"

[feature.dev.dependencies]
# Type stubs for better IDE support and type checking
types-tqdm = "*"
types-requests = "*"
types-paramiko = "*"
types-psycopg2 = "*"
types-setuptools = "*"

[feature.dev.pypi-dependencies]
# Type checker (using ty by Astral - makers of ruff and uv)
ty = "*"

# Git hooks framework for running checks before commits
pre-commit = "*"

# Better commit messages (conventional commits)
commitizen = "*"

[pypi-dependencies]
country-converter = "*"
dispy = "*"
hdf5storage = "*"
simplekml = "*"
usgs-libcomcat = "*"

[environments]
# Default environment includes dev features for local development
default = { features = ["dev"], solve-group = "default" }

# Docs environment for building documentation
docs = { features = ["docs"], solve-group = "default" }

[feature.docs.pypi-dependencies]
mkdocs = "*"
mkdocs-material = "*"
pymdown-extensions = "*"

[tasks]
# Testing
test = { cmd = "pytest" }
"test:verbose" = { cmd = "pytest -v" }
"test:cov" = { cmd = "pytest --cov=pgamit --cov-report=term-missing" }

# Linting and formatting
lint = { cmd = "ruff check pgamit com" }
"lint:fix" = { cmd = "ruff check --fix pgamit com" }
format = { cmd = "ruff format pgamit com" }
"format:check" = { cmd = "ruff format --check pgamit com" }

# Type checking
typecheck = { cmd = "ty check --output-format github pgamit com" }

# Documentation
"docs:serve" = { cmd = "mkdocs serve", depends-on = ["docs"] }
"docs:build" = { cmd = "mkdocs build", depends-on = ["docs"] }

# Pre-commit hooks
"precommit:install" = { cmd = "pre-commit install --install-hooks", depends-on = ["dev"] }
"precommit:run" = { cmd = "pre-commit run --all-files", depends-on = ["dev"] }

# All checks (useful for CI)
check = { cmd = "ruff check pgamit com && ruff format --check pgamit com && ty check pgamit com && pytest" }
# Utilities
# check-external = "which gfzrnx && which crx2rnx && which gpspace && which sh_gamit"
# pgamit = "pgamit --help"
# plot = "PlotETM.py <sitecode>"
