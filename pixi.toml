[workspace]
preview = ["pixi-build"]
channels = ["conda-forge"]
platforms = ["osx-arm64", "linux-64"]

[package]
name = "pgamit"
version = "1.2.36"
description = "Parallel.GAMIT"
repository = "https://github.com/demiangomez/Parallel.GAMIT"
authors = ["Demian Gomez"]
license = "BSD-3-Clause"

[package.build]
backend = { name = "pixi-build-python", version = "*" }

[package.host-dependencies]
python     = ">=3.10"     # keep host Python in line with run-time Python
setuptools = "*"          # required by pgamitâ€™s build backend
wheel      = "*"          # best practice with setuptools
pip        = "*"          # already implicitly present, declare explicitly

[dependencies]
python = ">=3.10"
pgamit = { path = "." }
basemap = "*"
geopy = "*"
h5py = "*"
matplotlib = "*"
networkx = "*"
numpy = ">=1.19.5"
pandas = "*"
paramiko = "*"
psycopg2-binary = "*"
scandir = ">=1.6"
scikit-learn = ">=1.1"
scipy = "*"
tqdm = "*"
pytest = "*"
pytest-cov = "*"
ruff = "*"
xmltodict = "*"
scikit-image = "*"
shapely = "*"
obspy = "*"
pip = "*"

[pypi-dependencies]
country-converter = "*"
dispy = "*"
hdf5storage = "*"
simplekml = "*"
usgs-libcomcat = "*"

[pypi-options]
# avoid pip-bin isolation for local editable install
no-build-isolation = ["pgamit"]

[environments.docs]
features = ["docs"]

[feature.docs.pypi-dependencies]
mkdocs = "*"
mkdocs-material = "*"
pymdown-extensions = "*"

[tasks]
# Testing
test = { cmd = "pytest" }
"test:verbose" = { cmd = "pytest -v" }
"test:cov" = { cmd = "pytest --cov=pgamit --cov-report=term-missing" }

# Linting and formatting
lint = { cmd = "ruff check pgamit com" }
"lint:fix" = { cmd = "ruff check --fix pgamit com" }
format = { cmd = "ruff format pgamit com" }
"format:check" = { cmd = "ruff format --check pgamit com" }

# Documentation
"docs:serve" = { cmd = "mkdocs serve" }
"docs:build" = { cmd = "mkdocs build" }

# All checks (useful for CI)
check = { cmd = "ruff check pgamit com && ruff format --check pgamit com && pytest" }

# Utilities
# check-external = "which gfzrnx && which crx2rnx && which gpspace && which sh_gamit"
# pgamit = "pgamit --help"
# plot = "PlotETM.py <sitecode>"
